import{s as V,h as N}from"./modalHelper-md1zrCQj.js";import{b as G,M as j}from"./bootstrap.esm-CU4uQQQ5.js";window.bootstrap=G;const q=document.querySelector("#nombre_cliente"),T=document.querySelector("#apellido_paterno"),w=document.querySelector("#apellido_materno"),b=document.querySelector("#nombre_despacho"),M=document.querySelector("#razon_social"),d=document.querySelector("#rfc"),f=document.querySelector("#email"),v=document.querySelector("#password"),L=document.querySelector("#telefono");document.querySelector("#direccion");const h=document.querySelector("#estado"),H=document.querySelector("#ciudad"),S=document.querySelector("#plan_seleccionado"),k=document.querySelector("#aceptar_terminos"),p=document.querySelector("#tituloNavegacion"),c=document.querySelector("#paginacion"),x=document.querySelector("#pill-reg1-tab"),B=document.querySelector("#pill-reg2-tab"),F=document.querySelector("#pill-reg3-tab"),A=document.querySelector("#pag_2"),C=document.querySelector("#pag_3"),y=document.querySelector("#btnSuscribirse"),X=document.querySelector("#errorNombre"),D=document.querySelector("#errorApellidoPaterno"),I=document.querySelector("#errorApellidoMaterno"),J=document.querySelector("#errorNombreDespacho"),Z=document.querySelector("#errorRazon"),P=document.querySelector("#errorRFC"),R=document.querySelector("#errorEmail"),_=document.querySelector("#errorPassword"),z=document.querySelector("#errorTelefono"),U=document.querySelector("#errorEstado"),$=document.querySelector("#errorCiudad"),K=document.querySelector("#errorPlan");document.querySelector("#errorTerminos");const Q=new j(document.getElementById("modalCarga"),{backdrop:"static",keyboard:!1}),W=new j(document.getElementById("modalError")),Y=new j(document.getElementById("modalSuccess"));p.innerHTML="Registro";x.addEventListener("click",function(){c.innerHTML="",c.innerHTML="1",A.classList.remove("active"),C.classList.remove("active"),p.innerHTML="Registro"});B.addEventListener("click",function(){c.innerHTML="",c.innerHTML="2",C.classList.remove("active"),p.innerHTML="Registro"});F.addEventListener("click",function(){c.innerHTML="",c.innerHTML="3",A.classList.remove("active"),p.innerHTML="Elige tu plan"});A.addEventListener("click",function(){c.innerHTML="",c.innerHTML="2",C.classList.remove("active"),B.classList.add("active"),x.classList.remove("active"),F.classList.remove("active"),p.innerHTML="Registro"});C.addEventListener("click",function(){c.innerHTML="",c.innerHTML="3",A.classList.remove("active"),F.classList.add("active"),x.classList.remove("active"),B.classList.remove("active"),p.innerHTML="Elige tu plan"});q.addEventListener("focusout",function(){q.value==""?r(q,X):a(q,X)});T.addEventListener("focusout",function(){T.value==""?r(T,D):a(T,D)});w.addEventListener("focusout",function(){w.value==""?r(w,I):a(w,I)});b.addEventListener("focusout",function(){b.value==""?r(b,J):a(b,J)});M.addEventListener("focusout",function(){M.value==""?r(M,Z):a(M,Z)});d.addEventListener("focusout",function(){let e=d.value.trim().toUpperCase(),o=re(e);d.value==""?(d.classList.remove("Validado"),d.classList.remove("NoValidado"),P.innerHTML=""):o==!1?r(d,P,"El RFC introducido no es válido"):o&&a(d,P)});f.addEventListener("focusout",function(){let e=oe(f.value);f.value==""?r(f,R):e==!1?r(f,R,"El correo no coincide con el formato requerido"):e&&a(f,R)});v.addEventListener("focusout",function(){let e=ee(v.value);v.value==""?r(v,_):e==!1?r(v,_,"La contraseña no coincide con el formato requerido"):e&&a(v,_)});L.addEventListener("focusout",function(){L.value==""?r(L,z):L.value.length<10?r(L,z,"EL número de teléfono está incompleto"):a(L,z)});h.addEventListener("focusout",function(){h.value==""?r(h,U):a(h,U)});H.addEventListener("focusout",function(){H.value==""?r(H,$):a(H,$)});S.addEventListener("focusout",function(){S.value==""?(S.classList.add("NoValidado"),K.innerHTML="El campo no puede quedar vacío"):(S.classList.remove("NoValidado"),S.classList.add("Validado"),K.innerHTML="")});k.addEventListener("click",function(){k.checked==!0?(y.disabled=!1,y.title="",k.value=!0):(y.disabled=!0,y.title="Debes aceptar los términos y condiciones")});function r(e,o,t="El campo no puede quedar vacío"){e.classList.remove("Validado"),e.classList.add("NoValidado"),o.innerHTML=t}function a(e,o){e.classList.remove("NoValidado"),e.classList.add("Validado"),o.innerHTML=""}function ee(e){return/^(?=.*[A-Z])(?=.*\d).{8,}$/.test(e)}function oe(e){return/^[a-zA-z0-9_.+-]+@[a-zA-z0-9-]+\.[a-zA-z0-9-.]+$/.test(e)}function re(e,o=!0){const t=/^([A-ZÑ&]{3,4}) ?(?:- ?)?(\d{2}(?:0[1-9]|1[0-2])(?:0[1-9]|[12]\d|3[01])) ?(?:- ?)?([A-Z\d]{2})([A\d])$/;let l=e.match(t);if(!l)return!1;const s=l.pop(),n=l.slice(1).join(""),i=n.length,u="0123456789ABCDEFGHIJKLMN&OPQRSTUVWXYZ Ñ",O=i+1;let E,m;i==12?E=0:E=481;for(var g=0;g<i;g++)E+=u.indexOf(n.charAt(g))*(O-g);return m=11-E%11,m==11?m=0:m==10&&(m="A"),s!=m&&(!o||n+s!="XAXX010101000")||!o&&n+s=="XEXX010101000"?!1:n+s}function te(e,o,t,l,s,n){if(window.screen){var i=(screen.width-l)/2,u=(screen.height-s)/2;t+=t!=""?",":"",t+=",left="+i+",top="+u}window.open(e,o,t+(t!=""?",":"")+"width="+l+",height="+s+",status = no, toolbar = no, menubar = no, location = no , directories=no")}y.addEventListener("click",async e=>{let o=document.querySelector("#AltaUsuarioForm"),t=new FormData(o),l=Object.fromEntries(t.entries()),s=JSON.stringify(l);V(Q),await new Promise(n=>setTimeout(n,2e3)),N(Q);try{const i=await(await fetch("https://api.lexialegal.site/api/register/user",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:s})).json();console.log(i);const u=i.access_token;if(!u)throw new Error("Registro fallido");if(await(await fetch("/guardar-token",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').content},body:JSON.stringify({token:u})})).json())te(i.data.stripe_session.url,"Transacción de pago","",1e3,800,"true"),V(Y),document.getElementById("mensajeExito").value=i.message,N(Y,2e3,()=>{window.location.href="https://web.lexialegal.site/casos"});else throw new Error("El usuario no pudo ser creado")}catch(n){console.error(n),V(W),N(W,2e3)}});
