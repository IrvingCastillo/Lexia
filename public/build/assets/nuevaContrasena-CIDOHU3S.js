import{s as d,h as n}from"./modalHelper-md1zrCQj.js";import{b as E,M as c}from"./bootstrap.esm-CU4uQQQ5.js";window.bootstrap=E;const a=document.querySelector("#password_new"),e=document.querySelector("#confirm_password"),i=document.querySelector("#errorRestaurarContra"),t=document.querySelector("#btnNuevaContrasena"),m=new c(document.getElementById("modalCarga"),{backdrop:"static",keyboard:!1}),l=new c(document.getElementById("modalError")),v=new c(document.getElementById("modalSuccess")),b=document.getElementById("mensajeError"),h=document.getElementById("mensajeExito");function f(s){return/^(?=.*[A-Z])(?=.*\d).{8,}$/.test(s)}a.addEventListener("input",function(){(e.value!==""||a.value==="")&&p()});e.addEventListener("input",function(){(e.value.length>7||e.value==="")&&p()});a.addEventListener("focusout",()=>{});function p(){let s=f(a.value),o=f(e.value);s&&o?a.value!==e.value?(a.classList.remove("Validado"),e.classList.remove("Validado"),a.classList.add("NoValidado"),e.classList.add("NoValidado"),t.disabled=!0,i.innerHTML="Las contraseñas no coinciden"):(a.classList.remove("NoValidado"),e.classList.remove("NoValidado"),a.classList.add("Validado"),e.classList.add("Validado"),t.disabled=!1,i.innerHTML=""):a.value===""&&e.value===""?(a.classList.remove("Validado"),e.classList.remove("Validado"),a.classList.add("NoValidado"),e.classList.add("NoValidado"),t.disabled=!0,i.innerHTML="Por favor llene los campos"):(a.classList.remove("Validado"),e.classList.remove("Validado"),a.classList.add("NoValidado"),e.classList.add("NoValidado"),t.disabled=!0,i.innerHTML="Por favor ingrese una contraseña válida")}t.addEventListener("click",async s=>{s.preventDefault();let o=document.querySelector("#RecuperarContrasenaForm"),L=new FormData(o),w=Object.fromEntries(L.entries()),V=JSON.stringify(w);d(m),await new Promise(r=>setTimeout(r,2e3)),n(m);try{const g=await(await fetch("/get-token")).json(),u=await fetch("https://api.lexialegal.site/api/reset-password",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:`Bearer ${g.token}`},body:V}),y=u.json();u.ok?(d(v),h.textContent="¡Contraseña reestablecida!",n(v,4e3,()=>{window.location.href="https://web.lexialegal.site/login"})):(d(l),b.textContent=y.message,n(l,2e3))}catch(r){console.error(r),d(l),n(l,2e3)}});
