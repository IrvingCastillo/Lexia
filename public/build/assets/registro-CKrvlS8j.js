import{s as R,h as V}from"./modalHelper-md1zrCQj.js";import{b as ee,M as k}from"./bootstrap.esm-CU4uQQQ5.js";window.bootstrap=ee;var oe="http://localhost:8000/";const q=document.querySelector("#nombre_cliente"),T=document.querySelector("#apellido_paterno"),h=document.querySelector("#apellido_materno"),w=document.querySelector("#nombre_despacho"),M=document.querySelector("#razon_social"),d=document.querySelector("#rfc"),f=document.querySelector("#email"),v=document.querySelector("#password"),L=document.querySelector("#telefono");document.querySelector("#direccion");const b=document.querySelector("#estado"),H=document.querySelector("#ciudad"),S=document.querySelector("#plan_seleccionado"),A=document.querySelector("#aceptar_terminos"),E=document.querySelector("#tituloNavegacion"),c=document.querySelector("#paginacion"),F=document.querySelector("#pill-reg1-tab"),j=document.querySelector("#pill-reg2-tab"),O=document.querySelector("#pill-reg3-tab"),C=document.querySelector("#pag_2"),N=document.querySelector("#pag_3"),y=document.querySelector("#btnSuscribirse"),x=document.querySelector("#errorNombre"),D=document.querySelector("#errorApellidoPaterno"),I=document.querySelector("#errorApellidoMaterno"),U=document.querySelector("#errorNombreDespacho"),J=document.querySelector("#errorRazon"),P=document.querySelector("#errorRFC"),_=document.querySelector("#errorEmail"),z=document.querySelector("#errorPassword"),B=document.querySelector("#errorTelefono"),Z=document.querySelector("#errorEstado"),$=document.querySelector("#errorCiudad"),K=document.querySelector("#errorPlan");document.querySelector("#errorTerminos");const Q=new k(document.getElementById("modalCarga"),{backdrop:"static",keyboard:!1}),W=new k(document.getElementById("modalError")),Y=new k(document.getElementById("modalSuccess")),G=new k(document.getElementById("modalErrorRegistro"));E.innerHTML="Registro";F.addEventListener("click",function(){c.innerHTML="",c.innerHTML="1",C.classList.remove("active"),N.classList.remove("active"),E.innerHTML="Registro"});j.addEventListener("click",function(){c.innerHTML="",c.innerHTML="2",N.classList.remove("active"),E.innerHTML="Registro"});O.addEventListener("click",function(){c.innerHTML="",c.innerHTML="3",C.classList.remove("active"),E.innerHTML="Elige tu plan"});C.addEventListener("click",function(){c.innerHTML="",c.innerHTML="2",N.classList.remove("active"),j.classList.add("active"),F.classList.remove("active"),O.classList.remove("active"),E.innerHTML="Registro"});N.addEventListener("click",function(){c.innerHTML="",c.innerHTML="3",C.classList.remove("active"),O.classList.add("active"),F.classList.remove("active"),j.classList.remove("active"),E.innerHTML="Elige tu plan"});q.addEventListener("focusout",function(){q.value==""?r(q,x):a(q,x)});T.addEventListener("focusout",function(){T.value==""?r(T,D):a(T,D)});h.addEventListener("focusout",function(){h.value==""?r(h,I):a(h,I)});w.addEventListener("focusout",function(){w.value==""?r(w,U):a(w,U)});M.addEventListener("focusout",function(){M.value==""?r(M,J):a(M,J)});d.addEventListener("focusout",function(){let e=d.value.trim().toUpperCase(),o=ne(e);d.value==""?(d.classList.remove("Validado"),d.classList.remove("NoValidado"),P.innerHTML=""):o==!1?r(d,P,"El RFC introducido no es válido"):o&&a(d,P)});f.addEventListener("focusout",function(){let e=te(f.value);f.value==""?r(f,_):e==!1?r(f,_,"El correo no coincide con el formato requerido"):e&&a(f,_)});v.addEventListener("focusout",function(){let e=re(v.value);v.value==""?r(v,z):e==!1?r(v,z,"La contraseña no coincide con el formato requerido"):e&&a(v,z)});L.addEventListener("focusout",function(){L.value==""?r(L,B):L.value.length<10?r(L,B,"EL número de teléfono está incompleto"):a(L,B)});b.addEventListener("focusout",function(){b.value==""?r(b,Z):a(b,Z)});H.addEventListener("focusout",function(){H.value==""?r(H,$):a(H,$)});S.addEventListener("focusout",function(){S.value==""?(S.classList.add("NoValidado"),K.innerHTML="El campo no puede quedar vacío"):(S.classList.remove("NoValidado"),S.classList.add("Validado"),K.innerHTML="")});A.addEventListener("click",function(){if(A.checked==!0)if(document.querySelector("#AltaUsuarioForm").checkValidity())y.disabled=!1,y.title="",A.value=!0;else{R(G),setTimeout(()=>{V(G),A.checked=!1},2e3);return}else y.disabled=!0,y.title="Debes aceptar los términos y condiciones"});function r(e,o,t="El campo no puede quedar vacío"){e.classList.remove("Validado"),e.classList.add("NoValidado"),o.innerHTML=t}function a(e,o){e.classList.remove("NoValidado"),e.classList.add("Validado"),o.innerHTML=""}function re(e){return/^(?=.*[A-Z])(?=.*\d).{8,}$/.test(e)}function te(e){return/^[a-zA-z0-9_.+-]+@[a-zA-z0-9-]+\.[a-zA-z0-9-.]+$/.test(e)}function ne(e,o=!0){const t=/^([A-ZÑ&]{3,4}) ?(?:- ?)?(\d{2}(?:0[1-9]|1[0-2])(?:0[1-9]|[12]\d|3[01])) ?(?:- ?)?([A-Z\d]{2})([A\d])$/;let l=e.match(t);if(!l)return!1;const s=l.pop(),n=l.slice(1).join(""),i=n.length,u="0123456789ABCDEFGHIJKLMN&OPQRSTUVWXYZ Ñ",X=i+1;let p,m;i==12?p=0:p=481;for(var g=0;g<i;g++)p+=u.indexOf(n.charAt(g))*(X-g);return m=11-p%11,m==11?m=0:m==10&&(m="A"),s!=m&&(!o||n+s!="XAXX010101000")||!o&&n+s=="XEXX010101000"?!1:n+s}function ae(e,o,t,l,s,n){if(window.screen){var i=(screen.width-l)/2,u=(screen.height-s)/2;t+=t!=""?",":"",t+=",left="+i+",top="+u}window.open(e,o,t+(t!=""?",":"")+"width="+l+",height="+s+",status = no, toolbar = no, menubar = no, location = no , directories=no")}y.addEventListener("click",async e=>{let o=document.querySelector("#AltaUsuarioForm"),t=new FormData(o),l=Object.fromEntries(t.entries()),s=JSON.stringify(l);R(Q),await new Promise(n=>setTimeout(n,2e3)),V(Q);try{const i=await(await fetch("https://api.lexialegal.site/api/register/user",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:s})).json();console.log(i);const u=i.access_token;if(!u)throw new Error("Registro fallido");if(await(await fetch("/guardar-token",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').content},body:JSON.stringify({token:u})})).json())ae(i.data.stripe_session.url,"Transacción de pago","",1e3,800,"true"),R(Y),document.getElementById("mensajeExito").value=i.message,V(Y,2e3,()=>{window.location.href=oe+"casos"});else throw new Error("El usuario no pudo ser creado")}catch(n){console.error(n),R(W),V(W,2e3)}});
